<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lesson Content</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"
    />
    <style>
      .wrapper {
        font-family: inherit;
        font-size: 10px;
        line-height: 1.6 !important;
        word-wrap: break-word;
        font-weight: 400;
      }

      .wrapper p {
        font-size: 1.6em;
        margin-top: 0.5em;
        margin-bottom: 0.5em;
      }

      .wrapper h1 {
        font-weight: 600;
        font-size: 2.4em;
      }

      .wrapper h2 {
        font-weight: 600;
        font-size: 2em;
      }

      .wrapper mark {
        background-color: #ffe0e0;
        border-radius: 0.4em;
        padding: 0.2em 0.5em;
      }

      .wrapper ul li,
      .wrapper ol li {
        font-size: 1.6em;
      }

      .wrapper blockquote {
        font-style: italic;
        padding: 1.6em;
        border-radius: 1.6em;
        background-color: #def4eb;
        margin-left: 0;
        margin-right: 0;
        text-indent: 3.5em;
        position: relative;
      }

      .wrapper blockquote p {
        margin: 0;
      }

      .wrapper blockquote::before {
        position: absolute;
        top: 0.6em;
        left: -1em;
        content: '"';
        font-size: 2em;
        text-align: left;
      }

      .wrapper pre {
        padding: 1.6em !important;
        border-radius: 1.6em !important;
        font-size: 1.6em !important;
      }

      .wrapper .table-wrapper {
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }

      .wrapper table {
        font-size: 1.6em;
        border-collapse: separate;
        border-spacing: 0;
        overflow: hidden;
        border: 1px solid #000;
        border-radius: 0.5em;
        margin: 0.5em auto;
        background-color: #fff;
        width: max-content;
        min-width: 100%;
      }

      .wrapper table th {
        font-weight: 600;
        background-color: rgba(0, 0, 0, 0.2);
        border-bottom-width: 2px;
      }

      .wrapper table th,
      .wrapper table td {
        padding: 0.5em;
        border: 1px solid #000;
      }

      .wrapper table tr th,
      .wrapper table tr td {
        border-top: none;
      }

      .wrapper table tr th:first-child,
      .wrapper table tr td:first-child {
        border-left: none;
      }

      .wrapper table tr th:last-child,
      .wrapper table tr td:last-child {
        border-right: none;
      }

      .wrapper table tr:last-child td {
        border-bottom: none;
      }
      .wrapper figure {
        margin-left: 0;
        margin-right: 0;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <!-- content -->
    </div>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>
    <script>
      // html-da codebloklary tapyp dilini kesgitleya we olary kolleksiya yerleshdirya yerleshdirya
      function parseCodeLanguages(htmlString) {
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlString, "text/html");

        const codeblocks = doc.querySelectorAll("pre > code[class*='language-']");
        const languages = new Set();

        if (codeblocks.length > 0) {
          codeblocks.forEach((codeblock) => {
            codeblock.classList.forEach((cls) => {
              if (cls.startsWith("language-")) {
                languages.add(
                  codeblock.getAttribute("class").replace("language-", "").toLowerCase(),
                );
              }
            });
          });
        }
        return languages;
      }

      // highlight ucin dillerin kolleksiyasy
      const LANGUAGES_MAP = {
        typescript: ["clike", "javascript", "typescript"],
        swift: ["swift"],
      };

      // ulanylyan dillerin scriptini dynamic load edya
      async function getHighlightingScripts(htmlString) {
        const languages = parseCodeLanguages(htmlString);
        const loaded = new Set();

        for (const language of languages) {
          const deps = LANGUAGES_MAP[language];
          if (!deps) continue;

          for (const dep of deps) {
            if (loaded.has(dep)) continue;
            await new Promise((resolve) => {
              const script = document.createElement("script");
              script.src = `https://cdn.jsdelivr.net/npm/prismjs/components/prism-${dep}.min.js`;
              script.onload = resolve;
              document.body.appendChild(script);
            });
            loaded.add(dep);
          }
        }
      }

      // root fontSize calyshmak
      function mobileFontSizeChange(fontSize) {
        if (typeof fontSize !== "number") return;
        const wrapper = document.querySelector(".wrapper");
        if (wrapper instanceof HTMLElement) {
          wrapper.style.fontSize = `${fontSize}px`;
        }
      }

      function highlight() {
        if (window.Prism) {
          Prism.highlightAll();
        } else {
          console.error("Prism.js yuklenmedi");
        }
      }

      function tableWrappingForIOS() {
        const tables = document.querySelectorAll("table");
        tables.forEach((table) => {
          const tableWrapper = document.createElement("div");
          tableWrapper.classList.add("table-wrapper");
          table.parentNode.insertBefore(tableWrapper, table);
          tableWrapper.appendChild(table);
        });
      }

      window.addEventListener("DOMContentLoaded", () => {
        console.log("[js]: Dom loaded");
        const wrapper = document.querySelector(".wrapper");
        console.log("[js]: Wrapper element", wrapper);
        console.log("[js]: Wrapper element inner content", wrapper?.innerHTML);
        if (wrapper?.innerHTML) {
          const content = wrapper.innerHTML;
          getHighlightingScripts(content).then(() => {
            highlight();
            tableWrappingForIOS();
          });
        }
      });
    </script>
  </body>
</html>
